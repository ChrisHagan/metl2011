<Window x:Class="SandRibbon.Components.BannedContent.BannedContent"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:SandRibbon="clr-namespace:SandRibbon"
    xmlns:api="clr-namespace:SandRibbon;assembly=SandRibbonInterop"
    xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
    Title="Banned Content"
    x:Name="bannedContent"
    SizeToContent="WidthAndHeight">
    <Window.Resources>
        <CollectionViewSource Source="{Binding Path=submissionList}" x:Key="sortedSubmissionsView">
            <CollectionViewSource.SortDescriptions>
                <scm:SortDescription PropertyName="time"/>
            </CollectionViewSource.SortDescriptions>     
        </CollectionViewSource>
    </Window.Resources>
    <Border Background="{StaticResource BackgroundBlueGradient}">
        <DockPanel>
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Bottom">
                <Button x:Name="emailReport" ToolTip="{DynamicResource EmailReportTooltip}" Click="emailReport_Click" HorizontalAlignment="Right">Email Report</Button>
            </StackPanel>
            <Grid MaxHeight="450">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition MaxWidth="325"/>
                    <ColumnDefinition MinWidth="500"/>
                    <ColumnDefinition MaxWidth="325"/>
                </Grid.ColumnDefinitions>
                <ListBox Grid.Column="0" x:Name="submissions" SelectionMode="Single" Background ="Transparent" SelectedIndex="0"
                         ScrollViewer.HorizontalScrollBarVisibility="Disabled" ScrollViewer.VerticalScrollBarVisibility="Auto"
                         ItemsSource="{Binding Source={StaticResource sortedSubmissionsView}}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Viewbox Width="100" Height="100">
                                <Image Source="{Binding Path=url, Converter={x:Static SandRibbon:Converters.ConvertStringToImageSource}}" />
                            </Viewbox>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
                <Grid x:Name="GridContainer" Grid.Column="1" Width="Auto" Height="Auto" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                    <Label Height="35" HorizontalAlignment="Center" VerticalAlignment="Top" 
                           Content="{Binding 
                                        ElementName=submissions, 
                                        Path=SelectedItem,
                                        Converter={x:Static SandRibbon:Converters.ExtractSubmissionAuthor}}"/>
                    <Viewbox Margin="0,35,0,0" Height="Auto" Width="{Binding ElementName=GridContainer, Path=ActualWidth}" VerticalAlignment="Top" HorizontalAlignment="Left" >
                        <Image x:Name="previewImage" Source="{Binding ElementName=submissions, Path=SelectedItem, 
                        Converter={x:Static SandRibbon:Converters.ExtractUrlAndConvertConverter}}" Stretch="UniformToFill"/>
                    </Viewbox>
                </Grid>
                <DockPanel Grid.Column="2" LastChildFill="True">
                    <TextBlock DockPanel.Dock="Top" FontWeight="Bold">Banned Participants</TextBlock>
                    <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal">
                        <Button Content="Select All" Click="selectAll_Click"/>
                        <Button Content="Deselect All" Click="deselectAll_Click"/>
                        <Button Content="Unban Selected" Click="unbanSelected_Click"/>
                    </StackPanel>
                    <ListView x:Name="bannedUsernames" DockPanel.Dock="Top" Background="Transparent" SelectedIndex="0" 
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled" ItemsSource="{Binding ElementName=submissions,Path=SelectedItem.blacklisted}" 
                             ScrollViewer.VerticalScrollBarVisibility="Auto">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <CheckBox Margin="5" x:Name="participantCheckbox" Content="{Binding}" />
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </DockPanel>
            </Grid>
        </DockPanel>
    </Border>
</Window>
