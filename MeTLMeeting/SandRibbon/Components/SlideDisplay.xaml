<UserControl x:Class="SandRibbon.Components.SlideDisplay"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:SandRibbonInterop="clr-namespace:SandRibbonInterop;assembly=SandRibbonInterop"
    xmlns:components="clr-namespace:SandRibbon.Components"
    xmlns:api="clr-namespace:SandRibbon;assembly=SandRibbonInterop"
    xmlns:core="clr-namespace:System;assembly=mscorlib"
    xmlns:sr="http://schemas.divelements.co.uk/wpf/sandribbon"
    x:Name="SlideMeasure">
    <StackPanel Orientation="Vertical">
        <StackPanel.CommandBindings>
            <CommandBinding Command="{x:Static api:Commands.PostRetrievedHistoryPortion}" Executed="showHistoryProgress" />
        </StackPanel.CommandBindings>
        <components:SlideNavigationControls />
        <Grid>
            <SandRibbonInterop:SlideViewingListBox
                         ScrollViewer.HorizontalScrollBarVisibility="Disabled" 
                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                         OverridesDefaultStyle="False"
                         SelectionChanged="slides_SelectionChanged"
                         ParentActiveVariant="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type sr:RibbonGroup}}, Path=ActiveVariant}"
                         VerticalAlignment="Top" x:Name="slides">
                <SandRibbonInterop:SlideViewingListBox.ItemTemplate>
                    <DataTemplate DataType="{x:Type SandRibbonInterop:ThumbnailInformation}">
                        <Grid Name="slideItem" Width="{Binding ElementName=SlideMeasure, Path=ActualWidth}" Height="{Binding ElementName=SlideMeasure, Path=ActualWidth}">
                            <Rectangle Width="Auto" Height="Auto" Fill="{StaticResource BackgroundBlueGradient}" />
                            <Rectangle Width="Auto" Height="Auto" Fill="{Binding Path=thumbnail}"/>
                            <Rectangle Fill="DarkBlue" HorizontalAlignment="Right" VerticalAlignment="Bottom" RadiusX="9" RadiusY="9" Height="18" Width="18"/>
                            <Label FontSize="10" Foreground="White" HorizontalAlignment="Right" VerticalAlignment="Bottom" Content="{Binding Path=slideNumber}"/>
                        </Grid>
                    </DataTemplate>
                </SandRibbonInterop:SlideViewingListBox.ItemTemplate>
            </SandRibbonInterop:SlideViewingListBox>
            <components:LoadProgress x:Name="loadProgress" VerticalAlignment="Top" Margin="0,2,0,0" Height="40" Width="{Binding ElementName=slides, Path=ActualWidth}" Visibility="Collapsed"/>
        </Grid>
    </StackPanel>
</UserControl>